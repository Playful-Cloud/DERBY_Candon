<script>
    $(document).ready(function() {
        // Replace with your Google Sheet ID and API key
        const sheetId = "1B8vkEiOwZlNndMv5q5Ado3BXNXYystDciV9_r2wpQQk"; // Correct Sheet ID
        const apiKey = "AIzaSyBBRTnPTyQEHizMS9xv4tVbDAR0xYRA87k";
        const apiUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Sheet1?key=${apiKey}`;

        // Fetch data from Google Sheets
        $.getJSON(apiUrl, function(data) {
            const tableData = data.values; // Get rows as 2D array

            // Skip the header row and populate the table
            tableData.slice(1).forEach((rowData, index) => {
                const tableRow = `<tr>
                    <td>${index + 1}</td>
                    <td class="name-column">${rowData[0]}</td>
                    <td>${rowData[1]}</td>
                    <td>${rowData[2]}</td>
                    <td>${rowData[3]}</td>
                    <td>${rowData[4]}</td>
                    <td>${rowData[5]}</td>
                    <td>${rowData[6]}</td>
                    <td>${rowData[7]}</td>
                </tr>`;
                $('#resultsTable tbody').append(tableRow);
            });

            // Initialize DataTables
            $('#resultsTable').DataTable();
        }).fail(function(err) {
            console.error("Error fetching data: ", err);
        });
    });
</script>
